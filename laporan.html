<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Laporan</title>

<style>
body{
  font-family: Arial;
  font-size: 11px;
  margin: 10px;
}

.header{
  display:flex;
  justify-content:flex-end;
  align-items:center;
  gap:10px;
  margin-bottom:8px;
  font-size:12px;
}

table{
  border-collapse:collapse;
  width:100%;
  overflow-x:auto;
  white-space:nowrap;
}

th,td{
  border:1px solid #000;
  padding:4px;
  text-align:center;
}

th{
  background:#eee;
}

.left{
  text-align:left;
}
</style>
</head>

<body>

<!-- HEADER LOGIN -->
<div class="header">
  Login sebagai: <b id="userAktif">-</b>
  <button onclick="logout()">Logout</button>
</div>

<h3 style="text-align:center">
LAPORAN KEGIATAN LIBUR SEMESTER GANJIL<br>
TAHUN AJARAN 2025/2026
</h3>

<!-- IDENTITAS -->
<table>
<tr>
<td class="left">Nama</td>
<td><input id="nama" oninput="save()"></td>
<td class="left">Kelas</td>
<td><input id="kelas" oninput="save()"></td>
</tr>
</table>

<br>

<!-- TABEL KEGIATAN -->
<table>
<tr>
<th>No</th><th>Kegiatan</th>
<th>22</th><th>23</th><th>24</th><th>25</th><th>26</th>
<th>27</th><th>28</th><th>29</th><th>30</th><th>31</th>
<th>1</th><th>2</th><th>3</th><th>4</th><th>5</th>
</tr>

<script>
const kegiatan=[
"Salat 5 waktu",
"Salat sunnah (Fajr, Duha, Witir, Tahajud)",
"Zikir pagi dan petang",
"Membaca Iqro / Al-Qur’an",
"Berwudu & doa sebelum/sesudah tidur",
"Merapikan tempat tidur",
"Mengajak Abi & Umi salat tepat waktu",
"Merapikan kamar / rumah",
"Membantu menyiapkan makan/minum",
"Mendoakan kebaikan untuk Abi & Umi",
"Mencium kening Abi/Umi & mengucapkan sayang",
"Muroja’ah hafalan Al-Qur’an",
"Muroja’ah doa dan dalil",
"Muroja’ah matan tauhid",
"Muroja’ah Tuhfatul Athfal",
"Olahraga",
"Story and reading book",
"Berkunjung ke rumah teman/kerabat",
"Mengaji Al-Qur’an",
"Mendengarkan kajian",
"Membuat eksperimen / prakarya",
"Berkegiatan tanpa gadget"
];

kegiatan.forEach((k,i)=>{
  document.write("<tr><td>"+(i+1)+"</td><td class='left'>"+k+"</td>");
  for(let d=1; d<=15; d++){
    document.write("<td><input type='checkbox' id='k"+i+"_"+d+"' onclick='save()'></td>");
  }
  document.write("</tr>");
});
</script>
</table>

<!-- SAVE & LOAD -->
<script>
function save(){
  let data={};
  document.querySelectorAll("input").forEach(i=>{
    data[i.id] = (i.type==="checkbox") ? i.checked : i.value;
  });
  localStorage.setItem("laporan_data", JSON.stringify(data));
}

function load(){
  let data = JSON.parse(localStorage.getItem("laporan_data"));
  if(!data) return;
  Object.keys(data).forEach(id=>{
    let el=document.getElementById(id);
    if(el){
      el.type==="checkbox" ? el.checked=data[id] : el.value=data[id];
    }
  });
}

window.onload = load;
</script>

<!-- FIREBASE AUTH -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBzLuhR2fKyrPpPHEoVyvJS35RaX1pizmQ",
  authDomain: "laporan-libur.firebaseapp.com",
  projectId: "laporan-libur",
  storageBucket: "laporan-libur.firebasestorage.app",
  messagingSenderId: "867027958066",
  appId: "1:867027958066:web:93a7b424c642173f0a7f2b"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// CEK LOGIN
onAuthStateChanged(auth, user=>{
  if(!user){
    location.href="index.html";
  }else{
    document.getElementById("userAktif").innerText =
      user.email.replace("@laporan.com","");
  }
});

// LOGOUT
window.logout = function(){
  signOut(auth).then(()=>{
    location.href="index.html";
  });
};
</script>

</body>
</html>
